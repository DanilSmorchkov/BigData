# Лабораторная работа 3

### Задача

Необходимо самостоятельно обучить или дообучить модель, которая сможет анализировать видео с тренировочного процесса спортсменов занимающихся стендовой стрельбой, результатом работы должен быть лог событий происходящих на видео с шагом в 0.5 секунд представленных в формате CSV, который должен содержать примерно следующие колонки: имя файла с видео фрагментом, тип мишени, местоположение мишени относительно кадра, состояние мишени (целая, разбитая), момент фиксации кадра (например 0.5с c начала видео). После этого результат представленный CSV файлом надо прочитать при помощи Spark приложения и выявить серию из самых длинных серий без промахов.

### Ход выполнения:

Я решил дообучить YOLOv8 распозновать целые тарелки или осколки.

1. С помощью [скрипта](/Lab3/video_to_frame.py) я создал 3 папки с кадрами из видео с шагом 0.5 секунд. \
В [all_frames](/Lab3/all_frames) лежат просто все фотографии, которые необходимо отнести к одному из двух классов. \
В [train](/Lab3/train) и [val](/Lab3/val) лежат фотографии, размеченные мной с помощью библиотеки `labelImg`, для обучения и валидации (примерно 16% от всех данных).

2. Далее происходило [дообучение YOLOv8](/Lab3/train_model.py). Различные варианты запусков дообучения можно посмотреть [здесь](https://wandb.ai/danilsmor/YOLOv8?nw=nwuserdanilsmor). \
[Этот скрипт](/Lab3/val.py) необходим для непосредственной оценки работы модели на случайных фото из датасета.

3. Далее [генерируется](/Lab3/make_csv.py) [CSV файл](/Lab3/data.csv), о котором говорится в задании.

4. И в самом конце с помощью pyspark.sql происходит фильтрация CSV и определение самой длинной серии без промахов.


В конечном итоге с помощью данного пайплайна бын предсказан результат 10 выстрелов. Реальный ответ - 11 выстрелов. \
Более того, результаты для отдельных выездов по месяцам также обладают высоко точностью